# 功能規格：活動照片牆

**Feature Branch**: `001-event-photo-wall`
**Created**: 2025-11-17
**Status**: Draft
**Input**: User description: "活動照片牆是一個讓活動現場參與者即時上傳照片與留言的互動平台"

## User Scenarios & Testing _(mandatory)_

### User Story 1 - 參與者即時上傳照片 (Priority: P1)

參與者在活動現場使用手機拍攝照片後,可以立即上傳到照片牆。照片會在大螢幕上即時顯示,讓所有現場參與者都能看到。

**Why this priority**: 這是照片牆的核心功能,提供即時視覺回饋是活動互動的基礎。沒有這個功能,整個系統就失去了存在價值。

**Independent Test**: 可以透過參與者使用手機上傳一張照片,然後在大螢幕上看到該照片出現來完整測試。這個功能本身就能提供完整的使用者價值。

**Acceptance Scenarios**:

1. **Given** 參與者已進入活動照片牆頁面,**When** 點擊上傳按鈕並選擇一張照片,**Then** 照片應在 3 秒內出現在大螢幕照片牆上
2. **Given** 參與者正在上傳照片,**When** 上傳過程中網路中斷,**Then** 系統應顯示友善的錯誤訊息並允許重試
3. **Given** 參與者選擇了一張超大尺寸的照片(例如 10MB),**When** 上傳時,**Then** 系統應顯示上傳進度並在合理時間內完成(不超過 10 秒)
4. **Given** 多位參與者同時上傳照片,**When** 照片到達伺服器,**Then** 所有照片都應按時間順序顯示在照片牆上
5. **Given** 參與者上傳的照片包含敏感內容,**When** 照片出現在大螢幕上,**Then** 系統不進行內容審核,完全信任使用者;主辦方應在活動前向參與者說明使用規範

---

### User Story 2 - 發送彈幕留言 (Priority: P2)

參與者可以在活動中輸入文字留言,留言會以彈幕形式在大螢幕上飄過,讓所有人看到即時互動。

**Why this priority**: 彈幕功能增強了互動性和參與感,讓無法或不想上傳照片的參與者也能參與。但即使沒有彈幕,照片牆本身仍然有價值。

**Independent Test**: 可以透過參與者輸入一則留言,然後在大螢幕上看到彈幕飄過來完整測試。這個功能可以獨立於照片上傳功能運作。

**Acceptance Scenarios**:

1. **Given** 參與者已進入活動照片牆頁面,**When** 輸入文字並點擊發送,**Then** 彈幕應在 2 秒內出現在大螢幕上並從右向左飄過
2. **Given** 參與者輸入了超過字數限制的留言(假設 100 字),**When** 嘗試發送,**Then** 系統應提示字數限制並阻止發送
3. **Given** 參與者輸入了包含不當內容的留言,**When** 嘗試發送,**Then** 系統應使用基本敏感詞黑名單過濾,阻擋包含不當詞彙的留言並提示使用者修改
4. **Given** 大量參與者同時發送彈幕,**When** 彈幕在螢幕上顯示,**Then** 系統應控制彈幕密度避免畫面過於擁擠(例如同時最多顯示 10 條)
5. **Given** 彈幕正在大螢幕上飄過,**When** 活動時間結束,**Then** 彈幕應自然消失不再顯示

---

### User Story 3 - 無需登入快速加入 (Priority: P1)

參與者只需要知道活動識別碼(例如活動代碼或 QR Code),就能立即開始上傳照片和發送留言,無需註冊帳號或登入。

**Why this priority**: 降低參與門檻是提升活動互動率的關鍵。如果需要註冊登入,會大幅降低參與意願。這個功能雖然看似簡單,但對使用者體驗至關重要。

**Independent Test**: 可以透過參與者掃描 QR Code 或輸入活動代碼,直接進入照片牆頁面並開始互動來測試。無需任何個人資訊即可完成整個流程。

**Acceptance Scenarios**:

1. **Given** 活動主辦方已建立活動,**When** 參與者掃描活動 QR Code,**Then** 應直接進入該活動的照片牆頁面
2. **Given** 參與者沒有 QR Code 掃描器,**When** 手動輸入活動代碼(例如 6 位數字),**Then** 應能成功進入活動
3. **Given** 參與者輸入了不存在的活動代碼,**When** 嘗試加入,**Then** 系統應顯示友善的錯誤訊息
4. **Given** 參與者已進入活動照片牆,**When** 關閉瀏覽器後重新開啟,**Then** 應記住活動代碼無需再次輸入(使用瀏覽器 session)
5. **Given** 活動已結束,**When** 參與者嘗試加入,**Then** 系統應顯示活動已結束的訊息

---

### User Story 4 - 大螢幕即時顯示 (Priority: P1)

活動主辦方可以在大螢幕上全螢幕顯示照片牆,展示所有參與者上傳的照片和彈幕,營造即時互動氛圍。

**Why this priority**: 大螢幕展示是照片牆的核心價值所在。沒有大螢幕展示,照片和留言就失去了「公開分享」和「即時互動」的意義。

**Independent Test**: 可以透過在大螢幕上開啟照片牆顯示頁面,然後驗證新上傳的照片和彈幕會即時出現來測試。這個功能提供活動的視覺焦點。

**Acceptance Scenarios**:

1. **Given** 主辦方已在大螢幕上開啟照片牆顯示頁面,**When** 參與者上傳新照片,**Then** 照片應在 3 秒內自動出現在大螢幕上
2. **Given** 照片牆正在大螢幕上顯示,**When** 有新照片加入,**Then** 照片應以視覺上吸引人的方式排列(例如瀑布流或網格)
3. **Given** 大螢幕正在顯示照片牆,**When** 參與者發送彈幕,**Then** 彈幕應即時飄過螢幕不遮擋照片
4. **Given** 活動已累積大量照片(例如 100 張以上),**When** 大螢幕顯示照片牆,**Then** 系統應平滑載入和顯示照片不卡頓
5. **Given** 大螢幕長時間顯示照片牆,**When** 沒有新內容時,**Then** 可以輪播展示既有照片保持畫面活躍

---

### Edge Cases

- **網路不穩定時**: 參與者在訊號弱的活動場地上傳照片時,系統應顯示上傳進度並在失敗時提供重試機制
- **活動結束後**: 照片儲存在參與者自己的 Google Drive 中,系統不儲存照片副本;彈幕留言不存入資料庫,顯示完畢後即消失
- **大量並發上傳**: 當活動高峰期(例如精彩時刻)有 50+ 人同時上傳照片時,系統應保持響應速度不降低
- **不當內容處理**: 照片完全信任使用者不審核;彈幕使用敏感詞黑名單過濾
- **活動代碼衝突**: 系統應確保活動代碼唯一性,避免參與者誤入其他活動
- **照片尺寸過大**: 應限制照片檔案大小(建議 10MB)並在前端進行壓縮
- **螢幕解析度差異**: 大螢幕顯示應適應不同解析度(1080p, 4K 等)
- **瀏覽器相容性**: 應支援主流行動瀏覽器(iOS Safari, Android Chrome)
- **同一參與者大量上傳**: 應限制單一使用者的上傳頻率(例如每 10 秒最多 1 張照片)避免濫用

## Requirements _(mandatory)_

### Functional Requirements

- **FR-001**: 系統必須允許參與者透過 Google Drive Folder ID 上傳照片
- **FR-002**: 系統必須即時顯示上傳的照片在大螢幕照片牆上(延遲不超過 3 秒)
- **FR-003**: 照片必須儲存在參與者自己的 Google Drive 中
- **FR-004**: 參與者必須能夠發送文字留言作為彈幕
- **FR-005**: 系統必須在大螢幕上以彈幕形式顯示留言(從右向左飄過)
- **FR-006**: 彈幕留言不得存入資料庫,僅在顯示時即時傳輸
- **FR-007**: 系統必須實施基本敏感詞黑名單過濾彈幕內容
- **FR-008**: 參與者必須能透過活動識別碼(代碼或 QR Code)加入活動,無需註冊或登入
- **FR-009**: 系統必須為每個活動產生唯一的活動代碼
- **FR-010**: 系統必須提供 QR Code 供參與者快速加入活動
- **FR-011**: 主辦方必須能建立新活動並取得活動代碼和 QR Code
- **FR-012**: 系統必須限制照片檔案大小(上限 20MB)
- **FR-013**: 系統必須限制彈幕文字長度(上限 50 字)
- **FR-014**: 系統必須支援多個活動同時進行互不干擾
- **FR-015**: 大螢幕顯示必須支援全螢幕模式
- **FR-016**: 系統必須在上傳失敗時提供重試機制
- **FR-017**: 系統必須顯示上傳進度回饋給使用者
- **FR-018**: 系統必須控制彈幕顯示密度避免畫面過於擁擠
- **FR-019**: 系統必須限制單一參與者的上傳頻率防止濫用(每 60 秒最多 20 張照片)
- **FR-020**: 系統必須在活動不存在或已結束時顯示友善的錯誤訊息
- **FR-021**: 系統必須記住參與者的活動 session,關閉瀏覽器後重新開啟無需再次輸入代碼
- **FR-022**: 照片牆顯示必須適應不同螢幕解析度和尺寸
- **FR-023**: 照片不進行內容審核,完全信任使用者

### Key Entities

- **活動 (Event)**: 代表一個實體活動場次,包含活動代碼、建立時間、結束時間、狀態(進行中/已結束)
- **照片參考 (Photo Reference)**: 指向參與者 Google Drive 中照片的臨時連結,包含 Google Drive 檔案 ID、上傳時間、所屬活動、顯示權限(臨時公開連結)
- **彈幕訊息 (Danmaku Message)**: 即時傳輸的文字留言,不持久化儲存;包含留言內容、發送時間戳、所屬活動(僅用於即時路由)
- **參與者 Session**: 臨時的參與者識別(不是真實帳號),用於追蹤同一參與者的操作和限制頻率;可能包含 Google OAuth token 用於 Drive 存取

## Success Criteria _(mandatory)_

### Measurable Outcomes

- **SC-001**: 參與者從掃描 QR Code 到成功上傳第一張照片的時間不超過 30 秒
- **SC-002**: 照片從上傳完成到出現在大螢幕的延遲時間不超過 3 秒
- **SC-003**: 系統能同時支援單一活動中 100 位參與者並發上傳照片和彈幕而不降低響應速度
- **SC-004**: 90% 的參與者能在第一次嘗試時成功上傳照片和發送彈幕
- **SC-005**: 大螢幕照片牆能連續顯示 4 小時以上而不出現效能問題或卡頓
- **SC-006**: 系統不儲存照片副本(照片保留在參與者自己的 Google Drive);彈幕留言不持久化儲存
- **SC-007**: 系統支援主流行動裝置瀏覽器(iOS Safari 15+, Android Chrome 90+)且功能完整
- **SC-008**: 彈幕顯示流暢度達到每秒 30 幀以上,即使在大量彈幕時也不卡頓
- **SC-009**: 照片上傳成功率達到 95% 以上(排除使用者主動取消)
- **SC-010**: 參與者對「加入活動的便利性」滿意度達到 4.5/5 分以上

## Assumptions

為了在沒有完整需求的情況下推進規格制定,我們做出以下假設:

1. **資料保留政策**: 照片儲存在參與者自己的 Google Drive 中,系統不保留副本;彈幕留言不存入資料庫,顯示完即消失
2. **Google Drive 整合**: 參與者需授權系統存取 Google Drive 的檔案上傳權限;系統僅取得臨時公開連結用於顯示
3. **活動代碼格式**: 使用 6 位數字作為活動代碼,易於記憶和輸入
4. **彈幕字數限制**: 50 字以內,涵蓋絕大多數短留言需求
5. **上傳頻率限制**: 每位參與者每 60 秒最多上傳 20 張照片,每 2 秒最多發送 1 則彈幕
6. **並發處理**: 系統設計目標為支援單一活動 500 位並發使用者,多個活動同時進行總計 2000 位使用者
7. **內容審核**: 照片完全信任使用者不進行審核;彈幕實施基本敏感詞黑名單過濾
8. **照片牆布局**: 使用瀑布流或網格布局自動排列照片,最新照片出現在最上方
9. **技術相容性**: 目標支援 iOS Safari 15+, Android Chrome 90+,覆蓋 95% 以上的行動裝置使用者
10. **隱私保護**: 系統設計核心為零資料儲存,完全符合隱私保護要求;參與者對自己的照片擁有完全控制權
